<div class="container">
  <h1>Gerenciador de Tarefas</h1>

  <app-tarefa-form
    [tarefaEditando]="tarefaEditando"
    (salvar)="onSalvarTarefa($event)"
    (cancelar)="onCancelarEdicao()">
  </app-tarefa-form>

  <div *ngIf="erro" class="alert alert-error">
    {{ erro }}
  </div>

  <div *ngIf="carregando && tarefas.length === 0" class="loading">
    Carregando tarefas...
  </div>

  <div *ngIf="!carregando && tarefas.length > 0" class="tarefas-list">
    <div *ngFor="let tarefa of tarefas" 
         class="tarefa-item" 
         [class.concluida]="tarefa.feito">
      
      <div class="tarefa-content">
        <input
          type="checkbox"
          [checked]="tarefa.feito"
          (change)="alternarStatusTarefa(tarefa.id)"
          class="checkbox"
          [disabled]="processandoIds.has(tarefa.id) || tarefaEditando !== undefined">
        
        <div class="tarefa-info">
          <span class="tarefa-id">#{{ tarefa.id }}</span>
          <span class="tarefa-descricao">{{ tarefa.descricao }}</span>
          <div class="tarefa-status">
            {{ tarefa.feito ? 'Conclu√≠da' : 'Pendente' }}
            <span *ngIf="processandoIds.has(tarefa.id)" class="processando-indicator">
              (processando)
            </span>
          </div>
        </div>
      </div>
      
      <div class="tarefa-actions">
        <button
          (click)="editarTarefa(tarefa)"
          class="btn btn-edit"
          [disabled]="tarefaEditando !== undefined || processandoIds.has(tarefa.id)">
          {{ processandoIds.has(tarefa.id) ? 'Aguarde' : 'Editar' }}
        </button>
        
        <button
          (click)="deletarTarefa(tarefa.id)"
          class="btn btn-delete"
          [disabled]="tarefaEditando !== undefined || processandoIds.has(tarefa.id)">
          {{ processandoIds.has(tarefa.id) ? 'Aguarde' : 'Excluir' }}
        </button>
      </div>
    </div>
  </div>

  <div *ngIf="!carregando && tarefas.length === 0" class="empty-state">
    <p>Nenhuma tarefa encontrada. Adicione uma nova tarefa.</p>
  </div>

  <div *ngIf="carregando && tarefas.length > 0" class="loading-light">
    Atualizando...
  </div>
</div>